(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9827:function(e,t,n){Promise.resolve().then(n.bind(n,6425)),Promise.resolve().then(n.t.bind(n,2773,23))},6425:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});var r=n(7437),a=n(2265);let i="ginkgo-theme";function s(e){let t=document.documentElement,n=window.matchMedia("(prefers-color-scheme: dark)").matches;t.classList.toggle("dark","dark"===e||"system"===e&&n)}var o=n(7651),l=n(7138),c=n(1169),d=n(495);let u=[{section:"我的账户",label:"概览",to:"/"},{section:"我的账户",label:"个人资料",to:"/profile"},{section:"我的账户",label:"安全中心",to:"/security"},{section:"我的账户",label:"安全日志",to:"/logs"},{section:"我的账户",label:"隐私与数据",to:"/privacy"},{section:"我的账户",label:"授权应用",to:"/authorized"},{section:"开发者",label:"客户端注册",to:"/clients",dev:!0},{section:"开发者",label:"应用日志",to:"/clients/logs",dev:!0},{section:"开发者",label:"授权用户",to:"/clients/users",dev:!0},{section:"开发者",label:"应用分析",to:"/clients/analytics",dev:!0},{section:"开发者",label:"平台状态",to:"/status",dev:!0},{section:"开发者",label:"OIDC 文档",to:"/docs",dev:!0},{section:"管理员",label:"全局仪表盘",to:"/admin/dashboard",admin:!0},{section:"管理员",label:"用户管理",to:"/admin/users",admin:!0},{section:"管理员",label:"客户端审批",to:"/admin/approvals",admin:!0},{section:"管理员",label:"审计日志",to:"/admin/logs",admin:!0},{section:"管理员",label:"系统策略",to:"/admin/settings",admin:!0},{section:"管理员",label:"品牌定制",to:"/admin/branding",admin:!0}];function f(e){let{children:t}=e,{me:n}=(0,o.a)(),[f,h]=(0,a.useState)("system");(0,a.useEffect)(()=>{h(localStorage.getItem(i)||"system")},[]);let m=(0,c.usePathname)(),[g,p]=(0,a.useState)("");(0,a.useEffect)(()=>{p(encodeURIComponent(window.location.pathname+window.location.search))},[]);let b=(0,a.useMemo)(()=>{let e=u.filter(e=>(!e.admin||null!=n&&!!n.is_admin)&&(!e.dev||null!=n&&!!n.is_admin||null!=n&&!!n.is_dev)),t=new Map;for(let n of e)t.has(n.section)||t.set(n.section,[]),t.get(n.section).push(n);return Array.from(t.entries())},[n]);return(0,r.jsxs)("div",{className:"min-h-screen grid grid-cols-12",children:[(0,r.jsxs)("aside",{className:"col-span-12 md:col-span-2 border-r border-border bg-background/60",children:[(0,r.jsx)("div",{className:"h-14 flex items-center px-4 text-base font-semibold",children:"GinkgoID"}),(0,r.jsx)("nav",{className:"px-3 py-3 space-y-4 text-sm",children:b.map(e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"px-2 text-xs font-semibold uppercase tracking-wide text-muted-foreground/80",children:t}),(0,r.jsx)("div",{className:"space-y-1",children:n.map(e=>{var t;if(!e.to)return(0,r.jsx)("div",{className:"px-3 py-2 text-muted-foreground/80",children:e.label},e.label);let n=m===e.to||null!==(t=null==m?void 0:m.startsWith(e.to+"/"))&&void 0!==t&&t;return e.external?(0,r.jsx)("a",{href:e.to,className:"block rounded-md px-3 py-2 hover:bg-secondary",target:"_blank",rel:"noreferrer",children:e.label},e.to):(0,r.jsx)(l.default,{href:e.to,className:"block rounded-md px-3 py-2 ".concat(n?"bg-primary text-primary-foreground":"hover:bg-secondary"),children:e.label},e.to)})})]},t)})})]}),(0,r.jsxs)("div",{className:"col-span-12 md:col-span-10 flex flex-col",children:[(0,r.jsxs)("header",{className:"h-14 border-b border-border flex items-center justify-between px-4 bg-background/60 backdrop-blur",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"".concat(n?n.is_admin?"管理员":"用户":""," 控制台")}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(d.z,{variant:"outline",onClick:()=>{let e="light"===f?"dark":"dark"===f?"system":"light";localStorage.setItem(i,e),s(e),h(e)},title:"主题：".concat(f),children:"dark"===f?"深色":"light"===f?"浅色":"跟随系统"}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:n.username}),(0,r.jsx)(d.z,{variant:"ghost",onClick:async()=>{let e=window.location.pathname+window.location.search;await fetch("/logout",{credentials:"include"}),window.location.href=e||"/"},children:"退出"})]}):(0,r.jsx)("a",{className:"btn",href:"/login?next=".concat(g),children:"登录"})]})]}),(0,r.jsx)("main",{className:"flex-1",children:t})]})]})}var h=n(7776);function m(e){let{children:t}=e;return(0,a.useEffect)(()=>{!function(){let e=localStorage.getItem(i)||"system";if(s(e),"system"===e){let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>s("system");try{e.addEventListener("change",t)}catch(n){e.addListener(t)}}}();let e="ginkgo-tailwind-css";if(!document.getElementById(e)){let t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href="/app.css",document.head.appendChild(t)}let t="ginkgo-inline-style";if(!document.getElementById(t)){let e=document.createElement("style");e.id=t,e.textContent="\n        body { background: #f6f7fb; color: #0f172a; }\n        .card { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 12px; color: #0f172a; }\n        .btn { background: #6366f1; color: #ffffff; border-radius: 8px; padding: 8px 16px; display: inline-flex; align-items: center; gap: 6px; text-decoration: none; font-weight: 600; }\n        .btn:hover { background: #4f46e5; }\n      ",document.head.appendChild(e)}},[]),(0,r.jsx)(o.H,{children:(0,r.jsxs)(f,{children:[t,(0,r.jsx)(h.x7,{richColors:!0,position:"top-right"})]})})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(7437);n(2265);var a=n(1538),i=n(3027),s=n(7440);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:n,size:i,asChild:l=!1,...c}=e,d=l?a.g7:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,s.cn)(o({variant:n,size:i,className:t})),...c})}},6264:function(e,t,n){"use strict";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={credentials:"include",headers:{Accept:"application/json",...t.headers||{}},...t},r=await fetch(e,n);if(401===r.status){let e=encodeURIComponent(window.location.pathname+window.location.search);throw window.location.href="/login?next=".concat(e),Error("unauthorized")}let a=await r.text(),i=r.headers.get("Content-Type")||"",s=a;if(i.includes("application/json"))try{s=JSON.parse(a)}catch(e){}if(!r.ok){let e=s&&(s.error||s.message)||r.statusText;throw Error("string"==typeof e?e:JSON.stringify(s))}return s}async function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(e,{method:n.method||"POST",headers:{"Content-Type":"application/json",...n.headers||{}},body:JSON.stringify(t)})}n.d(t,{h:function(){return r},j:function(){return a}})},7651:function(e,t,n){"use strict";n.d(t,{H:function(){return o},a:function(){return l}});var r=n(7437),a=n(2265),i=n(6264);let s=(0,a.createContext)(null);function o(e){let{children:t}=e,[n,o]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0),d=async()=>{try{let e=await (0,i.h)("/api/me");o(e)}catch(e){o(null)}finally{c(!1)}};(0,a.useEffect)(()=>{d()},[]);let u=async()=>{await fetch("/logout",{credentials:"include"}),window.location.href="/"},f=(0,a.useMemo)(()=>({me:n,loading:l,refresh:d,logout:u}),[n,l]);return(0,r.jsx)(s.Provider,{value:f,children:t})}function l(){return(0,a.useContext)(s)||{me:null,loading:!0,refresh:async()=>{},logout:async()=>{}}}},7440:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var r=n(4839),a=n(6164);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}},2773:function(){}},function(e){e.O(0,[234,247,776,138,971,23,744],function(){return e(e.s=9827)}),_N_E=e.O()}]);