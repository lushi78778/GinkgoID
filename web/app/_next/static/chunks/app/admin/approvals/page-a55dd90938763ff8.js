(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{4178:function(e,t,n){Promise.resolve().then(n.bind(n,4760))},4760:function(e,t,n){"use strict";n.r(t);var a=n(7437),r=n(2265),s=n(495),i=n(6013),o=n(837),l=n(3102),c=n(6201),d=n(5783),u=n(7776),f=n(6264);t.default=()=>{let[e,t]=(0,r.useState)([]),[n,g]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),[m,p]=(0,r.useState)(""),[v,b]=(0,r.useState)(!1),j=(0,r.useCallback)(async()=>{g(!0);try{let e=await (0,f.h)("/api/admin/clients/pending");t(e)}catch(e){u.Am.error("获取失败: "+(e.message||"无法获取待审批列表"))}finally{g(!1)}},[]);(0,r.useEffect)(()=>{j()},[j]);let w=async e=>{if(await (0,d.i)({title:"确认通过",content:"确定通过客户端 ".concat(e," 的申请？")}))try{await (0,f.h)("/api/admin/clients/".concat(e,"/approve"),{method:"POST"}),u.Am.success("审批通过：客户端 ".concat(e," 已通过")),j()}catch(e){u.Am.error("审批未成功: "+(e.message||"操作失败"))}},y=e=>{h(e),p(""),b(!0)},N=async()=>{if(x){if(!m.trim()){u.Am.error("请填写拒绝原因");return}try{await (0,f.j)("/api/admin/clients/".concat(x,"/reject"),{reason:m}),u.Am.success("已拒绝：客户端 ".concat(x," 已被拒绝")),b(!1),h(null),p(""),j()}catch(e){u.Am.error("拒绝未成功: "+(e.message||"操作失败"))}}};return(0,a.jsxs)(i.Zb,{className:"w-full max-w-4xl mx-auto mt-8 p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"待审批客户端"}),(0,a.jsx)(c.w,{columns:[{accessorKey:"client_id",header:"客户端ID"},{accessorKey:"client_name",header:"名称"},{accessorKey:"owner_user_id",header:"注册人ID"},{accessorKey:"created_at",header:"注册时间",cell:e=>{let{getValue:t}=e;return new Date(1e3*(t()||0)).toLocaleString()}},{id:"actions",header:"操作",cell:e=>{let{row:t}=e;return(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)(s.z,{size:"sm",onClick:()=>w(t.original.client_id),children:"通过"}),(0,a.jsx)(s.z,{size:"sm",variant:"destructive",onClick:()=>y(t.original.client_id),children:"拒绝"})]})}}],data:e,rowKey:e=>e.client_id,searchable:!0,searchPlaceholder:"搜索客户端ID/名称",loading:n}),(0,a.jsx)(o.Vq,{open:v,onOpenChange:b,children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsx)(o.fK,{children:(0,a.jsx)(o.$N,{children:"拒绝理由"})}),(0,a.jsx)(l.I,{value:m,onChange:e=>p(e.target.value),placeholder:"请填写拒绝原因",className:"mb-4"}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(s.z,{variant:"outline",onClick:()=>b(!1),children:"取消"}),(0,a.jsx)(s.z,{variant:"destructive",onClick:N,children:"确认拒绝"})]})]})})]})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var a=n(7437);n(2265);var r=n(1538),s=n(3027),i=n(7440);let o=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:n,size:s,asChild:l=!1,...c}=e,d=l?r.g7:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,i.cn)(o({variant:n,size:s,className:t})),...c})}},6013:function(e,t,n){"use strict";n.d(t,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return s},aY:function(){return c},ll:function(){return o}});var a=n(7437);n(2265);var r=n(7440);function s(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...n})}function i(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...n})}function o(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...n})}function l(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...n})}function c(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...n})}},5783:function(e,t,n){"use strict";async function a(e){let{title:t,content:n}=e,a=[t,n].filter(Boolean).join("\n")||"确认操作？";return Promise.resolve(window.confirm(a))}n.d(t,{i:function(){return a}})},6201:function(e,t,n){"use strict";n.d(t,{w:function(){return d}});var a=n(7437),r=n(2265),s=n(3514),i=n(4175),o=n(6975),l=n(3102),c=n(495);function d(e){var t;let{columns:n,data:d,rowKey:u,pageSize:f=10,searchable:g=!1,searchPlaceholder:x="搜索...",toolbarRender:h,loading:m}=e,[p,v]=r.useState([]),[b,j]=r.useState(""),w=(0,s.b7)({data:d,columns:n,state:{sorting:p,globalFilter:b},onSortingChange:v,onGlobalFilterChange:j,getCoreRowModel:(0,i.sC)(),getFilteredRowModel:(0,i.vL)(),getSortedRowModel:(0,i.tj)(),getPaginationRowModel:(0,i.G_)()});r.useEffect(()=>{w.setPageSize(f)},[f,w]);let y=(0,r.useMemo)(()=>u||((e,t)=>{var n;return null!==(n=null==e?void 0:e.id)&&void 0!==n?n:t}),[u]);return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:g&&(0,a.jsx)(l.I,{value:null!=b?b:"",placeholder:x,onChange:e=>j(e.target.value),className:"w-64"})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:h})]}),(0,a.jsx)("div",{className:"overflow-x-auto border rounded-md",children:(0,a.jsxs)(o.iA,{children:[(0,a.jsx)(o.xD,{children:w.getHeaderGroups().map(e=>(0,a.jsx)(o.SC,{children:e.headers.map(e=>{var t;return(0,a.jsx)(o.ss,{className:"whitespace-nowrap select-none",children:e.isPlaceholder?null:(0,a.jsxs)("div",{className:e.column.getCanSort()?"cursor-pointer select-none":"",onClick:e.column.getToggleSortingHandler(),children:[(0,s.ie)(e.column.columnDef.header,e.getContext()),null!==(t=({asc:" ▲",desc:" ▼"})[e.column.getIsSorted()])&&void 0!==t?t:null]})},e.id)})},e.id))}),(0,a.jsx)(o.RM,{children:m?(0,a.jsx)(o.SC,{children:(0,a.jsx)(o.pj,{colSpan:n.length,children:(0,a.jsx)("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"加载中..."})})}):(null===(t=w.getRowModel().rows)||void 0===t?void 0:t.length)?w.getRowModel().rows.map((e,t)=>(0,a.jsx)(o.SC,{children:e.getVisibleCells().map(e=>(0,a.jsx)(o.pj,{children:(0,s.ie)(e.column.columnDef.cell,e.getContext())},e.id))},y(e.original,t))):(0,a.jsx)(o.SC,{children:(0,a.jsx)(o.pj,{colSpan:n.length,children:(0,a.jsx)("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"暂无数据"})})})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mr-auto",children:["共 ",d.length," 条，页 ",w.getState().pagination.pageIndex+1," / ",w.getPageCount()||1]}),(0,a.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>w.previousPage(),disabled:!w.getCanPreviousPage(),children:"上一页"}),(0,a.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>w.nextPage(),disabled:!w.getCanNextPage(),children:"下一页"})]})]})}},837:function(e,t,n){"use strict";n.d(t,{$N:function(){return x},Vq:function(){return o},cN:function(){return g},cZ:function(){return u},fK:function(){return f},hg:function(){return l}});var a=n(7437);n(2265);var r=n(4858),s=n(7025),i=n(7440);function o(e){let{...t}=e;return(0,a.jsx)(r.fC,{"data-slot":"dialog",...t})}function l(e){let{...t}=e;return(0,a.jsx)(r.xz,{"data-slot":"dialog-trigger",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.h_,{"data-slot":"dialog-portal",...t})}function d(e){let{className:t,...n}=e;return(0,a.jsx)(r.aV,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function u(e){let{className:t,children:n,showCloseButton:o=!0,...l}=e;return(0,a.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,a.jsx)(d,{}),(0,a.jsxs)(r.VY,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...l,children:[n,o&&(0,a.jsxs)(r.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(s.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...n})}function g(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...n})}function x(e){let{className:t,...n}=e;return(0,a.jsx)(r.Dx,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...n})}},3102:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var a=n(7437);n(2265);var r=n(7440);function s(e){let{className:t,type:n,...s}=e;return(0,a.jsx)("input",{type:n,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}},6975:function(e,t,n){"use strict";n.d(t,{RM:function(){return o},SC:function(){return l},iA:function(){return s},pj:function(){return d},ss:function(){return c},xD:function(){return i}});var a=n(7437);n(2265);var r=n(7440);function s(e){let{className:t,...n}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...n})})}function i(e){let{className:t,...n}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...n})}function o(e){let{className:t,...n}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...n})}function l(e){let{className:t,...n}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...n})}function c(e){let{className:t,...n}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}function d(e){let{className:t,...n}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}},6264:function(e,t,n){"use strict";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={credentials:"include",headers:{Accept:"application/json",...t.headers||{}},...t},a=await fetch(e,n);if(401===a.status){let e=encodeURIComponent(window.location.pathname+window.location.search);throw window.location.href="/login?next=".concat(e),Error("unauthorized")}let r=await a.text(),s=a.headers.get("Content-Type")||"",i=r;if(s.includes("application/json"))try{i=JSON.parse(r)}catch(e){}if(!a.ok){let e=i&&(i.error||i.message)||a.statusText;throw Error("string"==typeof e?e:JSON.stringify(i))}return i}async function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(e,{method:n.method||"POST",headers:{"Content-Type":"application/json",...n.headers||{}},body:JSON.stringify(t)})}n.d(t,{h:function(){return a},j:function(){return r}})},7440:function(e,t,n){"use strict";n.d(t,{cn:function(){return s}});var a=n(4839),r=n(6164);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[247,776,514,753,971,23,744],function(){return e(e.s=4178)}),_N_E=e.O()}]);