(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[140],{1172:function(e,t,r){Promise.resolve().then(r.bind(r,1695))},1695:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var n=r(7437),s=r(2265),i=r(7651),a=r(6013),o=r(495),c=r(3102),l=r(7135),d=r(4421),u=r(6975),f=r(7776);let m=[{name:"openid",description:"基础身份标识",claims:["sub"]},{name:"profile",description:"姓名与头像等公开信息",claims:["name","preferred_username","picture"]},{name:"email",description:"邮箱地址与验证状态",claims:["email","email_verified"]}],p=[{name:"admin",description:"平台管理员",permissions:["users:manage","logs:view","clients:approve","settings:write"]},{name:"support",description:"客服支持",permissions:["users:view","logs:view"]}],h={password_min_length:10,password_require_number:!0,password_require_symbol:!0,token_ttl_seconds:3600,refresh_token_ttl_days:14,require_mfa:!1};function x(){let{me:e}=(0,i.a)(),t=!!(null==e?void 0:e.is_admin),[r,x]=(0,s.useState)(m),[g,b]=(0,s.useState)({name:"",description:"",claims:""}),[v,j]=(0,s.useState)(p),[w,y]=(0,s.useState)(h),[k,N]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{t&&(async()=>{try{let e=await fetch("/api/admin/settings",{credentials:"include"});if(!e.ok)throw Error(await e.text());let t=await e.json();Array.isArray(t.scopes)&&x(t.scopes),Array.isArray(t.roles)&&j(t.roles),t.policies&&y({...h,...t.policies})}catch(e){f.Am.error((null==e?void 0:e.message)||"无法加载设置，展示示例数据")}})()},[t]),!t)return(0,n.jsx)("div",{className:"container py-10",children:(0,n.jsxs)(a.Zb,{children:[(0,n.jsxs)(a.Ol,{children:[(0,n.jsx)(a.ll,{children:"系统级管理"}),(0,n.jsx)(a.SZ,{children:"需要管理员权限"})]}),(0,n.jsx)(a.aY,{children:(0,n.jsx)("a",{className:"btn",href:"/login?next=".concat(encodeURIComponent("/admin/settings")),children:"管理员登录"})})]})});let _=e=>{window.confirm("确定要移除 scope ".concat(e," 吗？"))&&x(t=>t.filter(t=>t.name!==e))},C=async()=>{try{let e=await fetch("/api/admin/scopes",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)});if(!e.ok)throw Error(await e.text());f.Am.success("Scope 配置已保存")}catch(e){f.Am.error((null==e?void 0:e.message)||"保存失败 (后端可能未实现)")}},S=(e,t)=>{j(r=>r.map(r=>r.name===e?{...r,permissions:r.permissions.includes(t)?r.permissions.filter(e=>e!==t):[...r.permissions,t]}:r))},A=async()=>{try{let e=await fetch("/api/admin/roles",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(v)});if(!e.ok)throw Error(await e.text());f.Am.success("角色权限配置已保存")}catch(e){f.Am.error((null==e?void 0:e.message)||"保存失败 (后端可能未实现)")}},E=async()=>{N(!0);try{let e=await fetch("/api/admin/policies",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(w)});if(!e.ok)throw Error(await e.text());f.Am.success("安全策略已保存")}catch(e){f.Am.error((null==e?void 0:e.message)||"保存失败 (后端可能未实现)")}finally{N(!1)}};return(0,n.jsxs)("div",{className:"container py-10 space-y-6",children:[(0,n.jsxs)(a.Zb,{children:[(0,n.jsxs)(a.Ol,{children:[(0,n.jsx)(a.ll,{children:"Scope 管理"}),(0,n.jsx)(a.SZ,{children:"定义平台支持的 scope 以及对应返回的用户 Claim 集合"})]}),(0,n.jsxs)(a.aY,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid gap-2 md:grid-cols-4",children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"Scope 名称"}),(0,n.jsx)(c.I,{value:g.name,onChange:e=>b({...g,name:e.target.value})})]}),(0,n.jsxs)("div",{className:"grid gap-1 md:col-span-2",children:[(0,n.jsx)(l._,{children:"说明"}),(0,n.jsx)(c.I,{value:g.description,onChange:e=>b({...g,description:e.target.value})})]}),(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"Claims (逗号分隔)"}),(0,n.jsx)(c.I,{value:g.claims,onChange:e=>b({...g,claims:e.target.value})})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(o.z,{onClick:()=>{if(!g.name.trim()){f.Am.error("请输入 scope 名称");return}let e={name:g.name.trim(),description:g.description.trim(),claims:g.claims.split(",").map(e=>e.trim()).filter(Boolean)};x(t=>[...t,e]),b({name:"",description:"",claims:""}),f.Am.success("已添加 scope (尚未保存到后端)")},children:"添加 Scope"}),(0,n.jsx)(o.z,{variant:"outline",onClick:C,children:"保存到后端"})]}),(0,n.jsx)("div",{className:"rounded-xl border border-border/60 bg-background/70",children:(0,n.jsxs)(u.iA,{children:[(0,n.jsx)(u.xD,{children:(0,n.jsxs)(u.SC,{children:[(0,n.jsx)(u.ss,{children:"Scope"}),(0,n.jsx)(u.ss,{children:"说明"}),(0,n.jsx)(u.ss,{children:"Claims"}),(0,n.jsx)(u.ss,{className:"w-[80px]",children:"操作"})]})}),(0,n.jsx)(u.RM,{children:r.map(e=>(0,n.jsxs)(u.SC,{children:[(0,n.jsx)(u.pj,{className:"font-mono text-xs",children:e.name}),(0,n.jsx)(u.pj,{className:"text-sm text-foreground",children:e.description||"-"}),(0,n.jsx)(u.pj,{children:(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:e.claims.map(e=>(0,n.jsx)("span",{className:"rounded-md bg-secondary px-2 py-0.5 text-[11px]",children:e},e))})}),(0,n.jsx)(u.pj,{children:(0,n.jsx)(o.z,{variant:"destructive",size:"sm",onClick:()=>_(e.name),children:"移除"})})]},e.name))})]})})]})]}),(0,n.jsxs)(a.Zb,{children:[(0,n.jsxs)(a.Ol,{children:[(0,n.jsx)(a.ll,{children:"管理后台角色权限"}),(0,n.jsx)(a.SZ,{children:"通过 RBAC 控制不同管理角色的访问权限，可为客服、审计等创建精细化角色"})]}),(0,n.jsxs)(a.aY,{className:"space-y-4",children:[(0,n.jsx)("div",{className:"rounded-xl border border-border/60 bg-background/70",children:(0,n.jsxs)(u.iA,{children:[(0,n.jsx)(u.xD,{children:(0,n.jsxs)(u.SC,{children:[(0,n.jsx)(u.ss,{children:"角色"}),(0,n.jsx)(u.ss,{children:"权限"})]})}),(0,n.jsx)(u.RM,{children:v.map(e=>(0,n.jsxs)(u.SC,{children:[(0,n.jsxs)(u.pj,{children:[(0,n.jsx)("div",{className:"text-sm text-foreground font-medium",children:e.name}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description||"-"})]}),(0,n.jsx)(u.pj,{children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:["users:view","users:manage","logs:view","clients:approve","settings:write"].map(t=>(0,n.jsxs)("label",{className:"flex items-center gap-2 text-xs bg-muted/40 px-2 py-1 rounded-md",children:[(0,n.jsx)("input",{type:"checkbox",checked:e.permissions.includes(t),onChange:()=>S(e.name,t)}),t]},t))})})]},e.name))})]})}),(0,n.jsx)(o.z,{variant:"outline",onClick:A,children:"保存角色配置"})]})]}),(0,n.jsxs)(a.Zb,{children:[(0,n.jsxs)(a.Ol,{children:[(0,n.jsx)(a.ll,{children:"全局安全策略"}),(0,n.jsx)(a.SZ,{children:"为所有用户统一配置密码复杂度、令牌有效期和 MFA 要求"})]}),(0,n.jsxs)(a.aY,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"密码最小长度"}),(0,n.jsx)(c.I,{type:"number",min:8,value:w.password_min_length,onChange:e=>y({...w,password_min_length:Number(e.target.value)})})]}),(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"访问令牌默认有效期 (秒)"}),(0,n.jsx)(c.I,{type:"number",min:600,value:w.token_ttl_seconds,onChange:e=>y({...w,token_ttl_seconds:Number(e.target.value)})})]}),(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"刷新令牌有效期 (天)"}),(0,n.jsx)(c.I,{type:"number",min:1,value:w.refresh_token_ttl_days,onChange:e=>y({...w,refresh_token_ttl_days:Number(e.target.value)})})]}),(0,n.jsxs)("div",{className:"grid gap-1",children:[(0,n.jsx)(l._,{children:"密码必须包含"}),(0,n.jsxs)("div",{className:"flex items-center gap-6 text-sm",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:w.password_require_number,onChange:e=>y({...w,password_require_number:e.target.checked})}),"数字"]}),(0,n.jsxs)("label",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:w.password_require_symbol,onChange:e=>y({...w,password_require_symbol:e.target.checked})}),"特殊字符"]})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-border/60 bg-muted/30 px-4 py-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-foreground",children:"强制所有用户启用 MFA"}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground",children:"开启后，用户下次登录将被要求绑定 MFA，管理员可豁免特定角色。"})]}),(0,n.jsx)(d.r,{checked:w.require_mfa,onCheckedChange:e=>y({...w,require_mfa:e})})]}),(0,n.jsx)(o.z,{onClick:E,disabled:k,children:k?"保存中...":"保存安全策略"})]})]})]})}},495:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var n=r(7437);r(2265);var s=r(1538),i=r(3027),a=r(7440);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:r,size:i,asChild:c=!1,...l}=e,d=c?s.g7:"button";return(0,n.jsx)(d,{"data-slot":"button",className:(0,a.cn)(o({variant:r,size:i,className:t})),...l})}},6013:function(e,t,r){"use strict";r.d(t,{Ol:function(){return a},SZ:function(){return c},Zb:function(){return i},aY:function(){return l},ll:function(){return o}});var n=r(7437);r(2265);var s=r(7440);function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}},3102:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var n=r(7437);r(2265);var s=r(7440);function i(e){let{className:t,type:r,...i}=e;return(0,n.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}},7135:function(e,t,r){"use strict";r.d(t,{_:function(){return a}});var n=r(7437);r(2265);var s=r(8364),i=r(7440);function a(e){let{className:t,...r}=e;return(0,n.jsx)(s.f,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},4421:function(e,t,r){"use strict";r.d(t,{r:function(){return a}});var n=r(7437);r(2265);var s=r(7479),i=r(7440);function a(e){let{className:t,...r}=e;return(0,n.jsx)(s.fC,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,n.jsx)(s.bU,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},6975:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},SC:function(){return c},iA:function(){return i},pj:function(){return d},ss:function(){return l},xD:function(){return a}});var n=r(7437);r(2265);var s=r(7440);function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,n.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",t),...r})})}function a(e){let{className:t,...r}=e;return(0,n.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})}},6264:function(e,t,r){"use strict";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={credentials:"include",headers:{Accept:"application/json",...t.headers||{}},...t},n=await fetch(e,r);if(401===n.status){let e=encodeURIComponent(window.location.pathname+window.location.search);throw window.location.href="/login?next=".concat(e),Error("unauthorized")}let s=await n.text(),i=n.headers.get("Content-Type")||"",a=s;if(i.includes("application/json"))try{a=JSON.parse(s)}catch(e){}if(!n.ok){let e=a&&(a.error||a.message)||n.statusText;throw Error("string"==typeof e?e:JSON.stringify(a))}return a}async function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(e,{method:r.method||"POST",headers:{"Content-Type":"application/json",...r.headers||{}},body:JSON.stringify(t)})}r.d(t,{h:function(){return n},j:function(){return s}})},7651:function(e,t,r){"use strict";r.d(t,{H:function(){return o},a:function(){return c}});var n=r(7437),s=r(2265),i=r(6264);let a=(0,s.createContext)(null);function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[c,l]=(0,s.useState)(!0),d=async()=>{try{let e=await (0,i.h)("/api/me");o(e)}catch(e){o(null)}finally{l(!1)}};(0,s.useEffect)(()=>{d()},[]);let u=async()=>{await fetch("/logout",{credentials:"include"}),window.location.href="/"},f=(0,s.useMemo)(()=>({me:r,loading:c,refresh:d,logout:u}),[r,c]);return(0,n.jsx)(a.Provider,{value:f,children:t})}function c(){return(0,s.useContext)(a)||{me:null,loading:!0,refresh:async()=>{},logout:async()=>{}}}},7440:function(e,t,r){"use strict";r.d(t,{cn:function(){return i}});var n=r(4839),s=r(6164);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},8149:function(e,t,r){"use strict";function n(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),!1===r||!n.defaultPrevented)return t?.(n)}}r.d(t,{Mj:function(){return n}}),"undefined"!=typeof window&&window.document&&window.document.createElement},8324:function(e,t,r){"use strict";r.d(t,{b:function(){return a},k:function(){return i}});var n=r(2265),s=r(7437);function i(e,t){let r=n.createContext(t),i=e=>{let{children:t,...i}=e,a=n.useMemo(()=>i,Object.values(i));return(0,s.jsx)(r.Provider,{value:a,children:t})};return i.displayName=e+"Provider",[i,function(s){let i=n.useContext(r);if(i)return i;if(void 0!==t)return t;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function a(e,t=[]){let r=[],i=()=>{let t=r.map(e=>n.createContext(e));return function(r){let s=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return i.scopeName=e,[function(t,i){let a=n.createContext(i),o=r.length;r=[...r,i];let c=t=>{let{scope:r,children:i,...c}=t,l=r?.[e]?.[o]||a,d=n.useMemo(()=>c,Object.values(c));return(0,s.jsx)(l.Provider,{value:d,children:i})};return c.displayName=t+"Provider",[c,function(r,s){let c=s?.[e]?.[o]||a,l=n.useContext(c);if(l)return l;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e)[`__scope${n}`];return{...t,...s}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(i,...t)]}},8364:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var n=r(2265),s=r(5171),i=r(7437),a=n.forwardRef((e,t)=>(0,i.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var o=a},5171:function(e,t,r){"use strict";r.d(t,{WV:function(){return o},jH:function(){return c}});var n=r(2265),s=r(4887),i=r(1538),a=r(7437),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,i.Z8)(`Primitive.${t}`),s=n.forwardRef((e,n)=>{let{asChild:s,...i}=e,o=s?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(o,{...i,ref:n})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function c(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},7479:function(e,t,r){"use strict";r.d(t,{fC:function(){return w},bU:function(){return y}});var n=r(2265),s=r(8149),i=r(1584),a=r(8324),o=r(1715),c=r(1336),l=r(5171),d=r(7437),u="Switch",[f,m]=(0,a.b)(u),[p,h]=f(u),x=n.forwardRef((e,t)=>{let{__scopeSwitch:r,name:a,checked:c,defaultChecked:f,required:m,disabled:h,value:x="on",onCheckedChange:g,form:b,...w}=e,[y,k]=n.useState(null),N=(0,i.e)(t,e=>k(e)),_=n.useRef(!1),C=!y||b||!!y.closest("form"),[S,A]=(0,o.T)({prop:c,defaultProp:null!=f&&f,onChange:g,caller:u});return(0,d.jsxs)(p,{scope:r,checked:S,disabled:h,children:[(0,d.jsx)(l.WV.button,{type:"button",role:"switch","aria-checked":S,"aria-required":m,"data-state":j(S),"data-disabled":h?"":void 0,disabled:h,value:x,...w,ref:N,onClick:(0,s.Mj)(e.onClick,e=>{A(e=>!e),C&&(_.current=e.isPropagationStopped(),_.current||e.stopPropagation())})}),C&&(0,d.jsx)(v,{control:y,bubbles:!_.current,name:a,value:x,checked:S,required:m,disabled:h,form:b,style:{transform:"translateX(-100%)"}})]})});x.displayName=u;var g="SwitchThumb",b=n.forwardRef((e,t)=>{let{__scopeSwitch:r,...n}=e,s=h(g,r);return(0,d.jsx)(l.WV.span,{"data-state":j(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});b.displayName=g;var v=n.forwardRef((e,t)=>{let{__scopeSwitch:r,control:s,checked:a,bubbles:o=!0,...l}=e,u=n.useRef(null),f=(0,i.e)(u,t),m=function(e){let t=n.useRef({value:e,previous:e});return n.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(a),p=function(e){let[t,r]=n.useState(void 0);return(0,c.b)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let n,s;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;n=t.inlineSize,s=t.blockSize}else n=e.offsetWidth,s=e.offsetHeight;r({width:n,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(s);return n.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(m!==a&&t){let r=new Event("click",{bubbles:o});t.call(e,a),e.dispatchEvent(r)}},[m,a,o]),(0,d.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...l,tabIndex:-1,ref:f,style:{...l.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function j(e){return e?"checked":"unchecked"}v.displayName="SwitchBubbleInput";var w=x,y=b},1715:function(e,t,r){"use strict";r.d(t,{T:function(){return o}});var n,s=r(2265),i=r(1336),a=(n||(n=r.t(s,2)))[" useInsertionEffect ".trim().toString()]||i.b;function o({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){let[i,o,c]=function({defaultProp:e,onChange:t}){let[r,n]=s.useState(e),i=s.useRef(r),o=s.useRef(t);return a(()=>{o.current=t},[t]),s.useEffect(()=>{i.current!==r&&(o.current?.(r),i.current=r)},[r,i]),[r,n,o]}({defaultProp:t,onChange:r}),l=void 0!==e,d=l?e:i;{let t=s.useRef(void 0!==e);s.useEffect(()=>{let e=t.current;if(e!==l){let t=l?"controlled":"uncontrolled";console.warn(`${n} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=l},[l,n])}return[d,s.useCallback(t=>{if(l){let r="function"==typeof t?t(e):t;r!==e&&c.current?.(r)}else o(t)},[l,e,o,c])]}Symbol("RADIX:SYNC_STATE")},1336:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(2265),s=globalThis?.document?n.useLayoutEffect:()=>{}}},function(e){e.O(0,[247,776,971,23,744],function(){return e(e.s=1172)}),_N_E=e.O()}]);